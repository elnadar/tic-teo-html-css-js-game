<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet" />

<style>
  /* General styles */
  * {
    box-sizing: border-box;
  }

  html,
  body {
    height: 100%;
    margin: 0;
    padding: 0;
    font-family: "Roboto", sans-serif;
    background-color: #eee;
  }

  /* Game container */
  #game {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
    padding: 20px;
  }

  /* Game board */
  #board {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    width: 300px;
    height: 300px;
    background-color: #fff;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
  }

  /* Game cells */
  .obj {
    background-color: #ddd;
    border: none;
    outline: none;
    font-size: 50px;
    color: #444;
    cursor: pointer;
    transition: background-color 0.2s ease-in-out;
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100px;
    width: 100px;
    border: solid #c1c1c1 1px;
  }

  .obj:hover {
    background-color: #ccc;
    color: #222;
  }

  /* Turn indicator */
  #turn {
    margin-bottom: 20px;
    font-size: 18px;
    font-weight: bold;
    color: #444;
    text-shadow: 0 0 10px #aaa;
  }

  /* Refresh button */
  button#refreshBtn {
    width: 100%;
    margin: 20px 0;
    background-color: #1a73e8;
    color: #fff;
    border: none;
    border-radius: 5px;
    padding: 10px 15px;
    font-size: 16px;
    cursor: pointer;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
    transition: background-color 0.2s ease-in-out;
  }

  button#refreshBtn:hover {
    background-color: #0052cc;
    color: #eee;
  }

  button#refreshBtn.loading {
    background-color: #ccc;
    cursor: default;
  }

  /* Modal styles */
  .modal {
    display: none;
    position: fixed;
    z-index: 1;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0, 0, 0, 0.4);
  }

  .modal-content {
    background-color: #fff;
    margin: 15% auto;
    padding: 20px;
    border: 1px solid #888;
    width: 80%;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
  }

  .close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
  }

  .close:hover,
  .close:focus {
    color: black;
    text-decoration: none;
    cursor: pointer;
  }

  #turn {
    font-size: 18px;
    font-weight: bold;
    color: #444;
    margin-bottom: 20px;
    text-shadow: 2px 2px #aaa;
    text-align: center;
  }
</style>
<div id="game">
  <div>
    <div id="turn">It is player X's turn</div>
    <div id="board">
      <span class="obj"></span>
      <span class="obj"></span>
      <span class="obj"></span>
      <span class="obj"></span>
      <span class="obj"></span>
      <span class="obj"></span>
      <span class="obj"></span>
      <span class="obj"></span>
      <span class="obj"></span>
    </div>

    <button id="refreshBtn">Refresh</button>
  </div>
</div>

<div id="myModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <p id="message"></p>
  </div>
</div>

<script>
  var currentLitter = true;
  var objArr = document.querySelectorAll(".obj");
  var moveCount = 0; // Add a move count variable

  objArr.forEach((element) => {
    element.onclick = function () {
      if (this.innerHTML == "") {
        this.innerHTML = currentLitter ? "X" : "O";
        currentLitter = !currentLitter;
        moveCount++; // Increment the move count
        updateTurn();

        // Check if someone has won the game
        if (checkForWin()) {
          showModal(`Player ${currentLitter ? "O" : "X"} has won the game!`);
          resetGame();
        }
        // Check if the game is a tie
        else if (moveCount == 9) {
          showModal("The game is a tie!");
          resetGame();
        }
      }
    };
  });

  function checkForWin() {
    // Check rows
    for (let i = 0; i < 3; i++) {
      if (
        objArr[i * 3].innerHTML == objArr[i * 3 + 1].innerHTML &&
        objArr[i * 3 + 1].innerHTML == objArr[i * 3 + 2].innerHTML &&
        objArr[i * 3].innerHTML != ""
      ) {
        return true;
      }
    }
    // Check columns
    for (let i = 0; i < 3; i++) {
      if (
        objArr[i].innerHTML == objArr[i + 3].innerHTML &&
        objArr[i + 3].innerHTML == objArr[i + 6].innerHTML &&
        objArr[i].innerHTML != ""
      ) {
        return true;
      }
    }
    // Check diagonals
    if (
      objArr[0].innerHTML == objArr[4].innerHTML &&
      objArr[4].innerHTML == objArr[8].innerHTML &&
      objArr[0].innerHTML != ""
    ) {
      return true;
    }
    if (
      objArr[2].innerHTML == objArr[4].innerHTML &&
      objArr[4].innerHTML == objArr[6].innerHTML &&
      objArr[2].innerHTML != ""
    ) {
      return true;
    }
    return false;
  }
  // Get the refresh button
  var refreshBtn = document.getElementById("refreshBtn");

  // Add an event listener to the refresh button
  refreshBtn.addEventListener("click", function () {
    // Call the refresh function
    resetGame();
  });

  // Add a resetGame function
  function resetGame() {
    // Get the refresh button
    var refreshBtn = document.getElementById("refreshBtn");

    // Disable the refresh button and add the loading class
    refreshBtn.disabled = true;
    refreshBtn.classList.add("loading");

    // Reset all the values in the obj elements to an empty string
    objArr.forEach((element) => {
      element.innerHTML = "";
    });
      
    // Reset the current litter and move count
    currentLitter = true;
    moveCount = 0;

    // Update the turn display
    updateTurn();

    // Re-enable the refresh button and remove the loading class
    refreshBtn.disabled = false;
    refreshBtn.classList.remove("loading");
  }

  function updateTurn() {
    document.getElementById("turn").innerHTML = `It is player ${
      !currentLitter ? "O" : "X"
    }'s turn`;
  }

  // Get the modal element
  var modal = document.getElementById("myModal");

  // Get the <span> element that closes the modal
  var span = document.getElementsByClassName("close")[0];

  // Get the message element
  var message = document.getElementById("message");

  // When the user clicks on <span> (x), close the modal
  span.onclick = function () {
    modal.style.display = "none";
  };

  // When the user clicks anywhere outside of the modal
  function showModal(text) {
    modal.style.display = "block";
    message.innerHTML = text;
  }
</script>
